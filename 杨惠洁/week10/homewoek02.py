from dashscope import MultiModalConversation  # 多模态对话功能
import dashscope  # DashScope SDK主库
import base64

dashscope.api_key = "sk-cc43ca2821f64bfa9c6e20bf0889d92c"


def classify_image(image_path):
    """
    图片分类
    """
    try:
        #读取图片并编码
        with open(image_path, 'rb') as f:
            image_data = base64.b64encode(f.read()).decode('utf-8')

        #调用大模型
        response = MultiModalConversation.call(
            model="qwen-vl-plus",
            messages=[
                {
                    "role": "user",
                    "content": [
                        {
                            "image": f"data:image/jpeg;base64,{image_data}"
                        },
                        {
                            "text": "请仔细识别这张图片，将图片中的文字输出'"
                        }
                    ]
                }
            ]
        )

        return response.output.choices[0].message.content

    except Exception as e:
        print(f"Error: {e}")
        return "无法识别图片"


print(classify_image("img02.png"))

# 输出：[{'text': '这是一张关于中国知网（CNKI）的学术论文页面截图。以下是对图片中文字内容的详细描述和整理：\n\n---\n\n**标题：**\n中国知网作为全球最大的中文期刊全文数据库，为科研工作者、期刊编辑、审稿专家提供了很多便利。\n\n**摘要：**\n本文以论文作者的角度，从选题的创新型、查阅参考文献、评审论文相似度以及选择发表期刊和规范参考文献书写格式四个方面对中国知网的使用和作用进行了评价，认为以中国知网为代表的数字图书馆在信息化时代定将成为学术论文写作的有力助手。\n\n**关键词：** 中国知网；数字图书馆；学术论文写作\n\n**文献分类号：** G258\n\n**文献标志码：** A\n\n**文章编号：** 1674-9324(2014)39-0124-02\n\n---\n\n**正文内容：**\n\n**一、中国知网的功能与特点**\n\n中国知网是全球最大的中文期刊全文数据库，拥有海量的学术资源。它收录了1979年至今约8000多种期刊的全文，以及1000多种报纸、300多家博士培养单位的优秀博士硕士学位论文等数据文献。可以说，正是以中国知网为代表的，包括维普、万方等全文数据库的出现改变了科技工作者以往在图书馆手工查阅文献的习惯，大大节省了时间，使迅速走进科技工作者的生活中，扮演着科技助手的重要角色，为研究人员的工作保驾护航。\n\n---\n\n**二、中国知网对学术研究的帮助**\n\n中国知网不仅提供了很多人性化、个性化的服务，帮助研究人员获取所需资料，还提供了丰富的学术资源。例如，在进行科学研究和论文选题时，研究人员可以通过中国知网快速、准确地找到相关领域的最新研究成果，避免重复性工作。此外，中国知网还提供了详细的文献信息，包括作者、摘要、关键词等，方便研究人员进行深入研究。\n\n---\n\n**三、用中国知网审阅内容的相似度**\n\n中国知网提供了强大的文献相似度检测功能，能够帮助研究人员判断论文的原创性和学术诚信。通过与中国知网的对比，可以快速、准确地检测出论文与其他文献的相似度，确保论文的原创性。同时，中国知网还提供了详细的相似度报告，帮助研究人员了解论文的具体相似部分，从而进行修改和完善。\n\n---\n\n**四、中国知网的局限性与改进建议**\n\n尽管中国知网在学术研究中发挥了重要作用，但仍存在一些局限性。例如，部分文献的版权问题可能导致某些资源无法访问，影响了研究的全面性。此外，中国知网的检索功能虽然强大，但在某些情况下仍需人工干预，以提高检索的准确性和效率。因此，建议中国知网进一步优化检索算法，增加更多元化的文献来源，提升用户体验。\n\n---\n\n**结论：**\n\n综上所述，中国知网作为全球最大的中文期刊全文数据库，为科研工作者提供了极大的便利。它不仅丰富了学术资源，还提高了研究效率，促进了学术交流。然而，随着信息技术的不断发展，中国知网也需要不断创新和完善，以更好地服务于学术研究的需求。\n\n---\n\n以上是对图片中文字内容的详细整理和描述。希望这对您有所帮助！如果有任何具体问题或需要进一步的信息，请随时告知。'}]
