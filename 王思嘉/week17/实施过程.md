# gpt4rec实施过程

## 核心
首先根据用户历史中的物品标题生成假设的“搜索查询”，然后通过搜索这些查询来检索推荐物品。

## 1. 数据准备
使用Amazon Beauty，Electronics 评论数据等公开数据集作为训练数据
对脏数据进行清洗
进行数据去重处理
按时间进行训练集，验证集和测试集的划分

## 2. 模型构建
采用预训练的 GPT-2作为生成模型
进行提示词构建
```
Previously, the customer has bought:
<ITEM TITLE 1>. <ITEM TITLE 2>...
In the future, the customer wants to buy
```
进行模型训练，使用前t-1个数据作为输入，最后一个数据作为目标，对模型进行微调
使用 Beam Search 生成多个查询，以捕捉用户的多方面兴趣

## 3. 检索模块
采用 BM25 作为检索模型，对每个生成的查询，使用 BM25 从物品库中检索最相关的物品
采用排序融合方法，按查询生成分数排序，从最高分查询开始，依次检索物品，每个查询检索k/m 个物品直至凑满k 个物品

## 4. 模型优化
使用 Adam 优化器进行模型微调和参数优化
通过网格搜索进行参数优化

