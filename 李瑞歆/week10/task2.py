import dashscope
from dashscope import MultiModalConversation

# 设置API Key
dashscope.api_key = "sk-e9961a40093b46d98ca6cf4be6fffc11"

# 准备消息
messages = [
    {
        "role": "user",
        "content": [
            {
                "image": "./pic/pic2.jpeg"
            },
            {
                "text": "这是一张影像学报告，输出报告的诊断内容"
            }
        ]
    }
]

# 调用云端模型
response = MultiModalConversation.call(
    model="qwen-vl-plus",  # 或 "qwen-vl-max"
    messages=messages,
    max_tokens=128,
)

# 输出结果
print(response.output.choices[0].message.content)

"""
D:\miniconda3\envs\py312\python.exe D:\Project\badou\nlp_study\李瑞歆\week10\task2.py 
[{'text': '这张影像学报告是一份CT检查的详细描述，主要针对腹部的影像学检查结果。以下是报告的主要诊断内容：\n\n---\n\n### **影像学报告**\n\n#### **基本信息**\n- **患者姓名**：未显示\n- **年龄**：69岁\n- **性别**：男\n- **病历号**：CT532082\n- **申请科室**：泌尿外科门诊\n- **检查时间**：2024年5月28日\n\n---\n\n#### **检查所见**\n1. **肝脏**：\n   - 肝脏形态大小正常，表面光滑，各叶比例正常。\n   - 肝内外胆管未见扩张，胆囊密度形态未见异常。\n   - 胰腺密度形态未见确切异常。\n   - 脾不大。\n\n2. **右肾实质**：\n   - 右肾实质内见一肿块，呈圆形低密度影，直径约1.2cm，边缘光滑。\n   - 腹膜后未见明确肿块，膀胱充盈尚可，形态规则，膀胱壁未见增厚。\n   - 膀胱精角锐利，前列腺未见钙化。\n   - 盆腔周围未见软组织包块，肌肉初治正常走行。\n   - 肠管腹壁未见明显增厚，其内可见多发钙化灶。\n\n3. **其他**：\n   - 病灶呈轻度渐进性强化，右肾实质类圆形稍低密度影，大小约为10.8×9.7cm，边缘光滑。\n   - 余未见异常。\n\n---\n\n#### **诊断结论**\n- **右肾实质内见一肿块**，呈圆形低密度影，直径约1.2cm，边缘光滑。\n- **肠管腹壁未见明显增厚**，其内可见多发钙化灶。\n- **建议结合临床及其他检查进一步评估**。\n\n---\n\n#### **建议**\n1. **结合临床**：建议结合患者的临床症状、体征及其他相关检查（如血液检查、肿瘤标志物等）进行综合评估。\n2. **进一步检查**：\n   - 可考虑进行增强CT或MRI检查，以进一步明确肿块的性质。\n   - 如果怀疑恶性病变，可能需要进行穿刺活检以明确病理诊断。\n3. **定期随访**：对于良性病变，建议定期随访观察肿块的变化情况。\n\n---\n\n### **总结**\n该报告显示右肾实质内有一个约1.2cm的圆形低密度肿块，边缘光滑，未见明显异常。肠管腹壁未见明显增厚，但存在多发钙化灶。建议结合临床及其他检查进一步评估肿块的性质，并根据具体情况决定是否需要进一步的治疗或随访。\n\n如果有任何疑问或需要进一步的解释，请及时与主治医生沟通。'}]
"""

