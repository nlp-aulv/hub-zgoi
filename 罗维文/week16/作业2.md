### 作业2
阅读下 https://github.com/redis/redis-vl-python 的项目和已有的代码，阅读 SemanticCache.py，找出其中存在bug。

1. 修复拼写错误 ：拼写错误 ： pormpts 应为 prompts （第73、74行）
2. 在 store 方法中：
   - Faiss索引 ：向量按添加顺序存储 [vec1, vec2, vec3, ...] (第42行)
   - Redis列表 ：使用 lpush 从左侧添加，顺序为 [qN, qN-1, ..., q2, q1] (第49行)
       - 使用rpush替代lpush
```
# 原代码
pipe.lpush(self.name + "list", q)  # 第49行

# 修正后
pipe.rpush(self.name + "list", q)  # 从右侧添加，保持与Faiss索引相同顺序
```
3. call方法中 filtered_ind 本应该是对应 数据库里面的下标  
但是原代码是 检索出的100个向量列表中的位置
```
# 原代码
filtered_ind = [i for i, d in enumerate(dis[0]) if d < self.distance_threshold]  # 第70行
filtered_prompts = [pormpts[i] for i in filtered_ind]  # 第74行

# 修正后
# 获取满足条件的Faiss索引ID
filtered_faiss_ids = [ind[0][i] for i, d in enumerate(dis[0]) if d < self.distance_threshold]
# 根据Faiss索引ID获取对应的prompt
filtered_prompts = [pormpts[faiss_id] for faiss_id in filtered_faiss_ids]
```
4.  在 clear_cache 方法中：并未删到问答对
```
# 原代码
pormpts = self.redis.lrange(self.name + "list", 0, -1)
self.redis.delete(*pormpts)  
# 错误：删除的是问题本身，而非带前缀的键

# 修正后
# 1. 获取所有问题文本
prompts = self.redis.lrange(self.name + "list", 0, -1)
# 2. 构建完整的键名并删除缓存项
cache_keys = [self.name + "key:" + q.decode() for q in prompts]
self.redis.delete(*cache_keys)
```


